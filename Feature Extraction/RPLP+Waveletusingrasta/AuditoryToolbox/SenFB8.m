  function [HSen, Bpe8, B8, A8]=SenFB8(W)
% function [HSen, Bpe8, B8, A8]=SenFB8(W);
%
% Computs the freq. responses of fiters in Seneff's model, stage 1
% for a sampling rate of 8kHz. The responses corresponds to a LMS
% fitting of original responses (for 16 kHz) of the first 35 filters
% of the 40 filter model.
% See Slaney's Auditory toolbox, function "SeneffEar.m"
%
% Returns also the filterbank definition for 8kHz as:
% Bpe8: FIR preemphasis filter (order 2)
% B8, A8: 6th order transfer function coefficients.
% NOTE: Chanells 16 to 35 are 5th order.
%
% Example:
%=========
% fs=8000;
% f=logspace(log10(50),log10(fs/2),500)';
% W=2*pi*f/fs;
% H=SenFB8(W);
% semilogx(f,db(H)), pause, semilogx(f,fase(H))

% F. Perdigao, Coimbra, 1996 (fp@it.uc.pt)



Bpe8=[  0.01495   0.49822  -0.51673 ];

B8( 1,:)=[   0.02831   0.03486  -0.04153  -0.00158   0.00763  -0.02711   0.00509 ];
B8( 2,:)=[   0.23074   1.33432   1.90051   1.04457   0.54001   0.49914   0.25086 ];
B8( 3,:)=[   0.22424   1.21355   1.49338   0.71048   0.34934   0.34339   0.24336 ];
B8( 4,:)=[   0.21602   1.08380   1.08548   0.46686   0.23503   0.19936   0.22214 ];
B8( 5,:)=[   0.20999   0.97234   0.74405   0.32817   0.17389   0.08495   0.20237 ];
B8( 6,:)=[   0.22356   0.89334   0.45653   0.27536   0.12845   0.00842   0.18164 ];
B8( 7,:)=[   0.25101   0.81897   0.21630   0.28248   0.08063  -0.03796   0.16152 ];
B8( 8,:)=[   0.20602   0.76728  -0.00429   0.31337   0.05148  -0.08917   0.15395 ];
B8( 9,:)=[   0.32004   0.66412  -0.13188   0.38889  -0.02261  -0.08164   0.13334 ];
B8(10,:)=[   0.42546   0.52627  -0.21870   0.46937  -0.10594  -0.06529   0.11590 ];
B8(11,:)=[   0.64938  -0.11974   0.08418   0.32875  -0.25391   0.08513   0.03103 ];
B8(12,:)=[   0.52799   0.16793  -0.13287   0.36078  -0.02795  -0.14209   0.12700 ];
B8(13,:)=[   0.31863   0.25173  -0.30384   0.39492  -0.03494  -0.14152   0.09802 ];
B8(14,:)=[   0.25812   0.47892  -0.74339   0.77475  -0.20208  -0.13089   0.11118 ];
B8(15,:)=[   0.37810   0.02756  -0.21089   0.33857  -0.00810  -0.16257   0.09214 ];
B8(16,:)=[   0.00000   0.32010  -0.01951   0.04581   0.10839   0.06001  -0.06980 ];
B8(17,:)=[   0.00000   0.36144  -0.22175   0.28926  -0.08306   0.15992  -0.06073 ];
B8(18,:)=[   0.00000   0.78372  -0.78700   0.92366  -0.38371   0.37868  -0.06870 ];
B8(19,:)=[   0.00000   0.97894  -1.37701   1.60496  -0.85312   0.50975  -0.04763 ];
B8(20,:)=[   0.00000   0.44761   0.16855  -0.83051   1.00716  -0.27222   0.02331 ];
B8(21,:)=[   0.00000   1.29656  -2.32698   2.63616  -1.49946   0.63909  -0.01172 ];
B8(22,:)=[   0.00000   1.85090  -4.82756   6.44885  -4.79980   2.13557  -0.40977 ];
B8(23,:)=[   0.00000   0.45542  -0.69801  -0.24276   1.34297  -1.13126   0.32152 ];
B8(24,:)=[   0.00000   0.48718  -0.79212  -0.10120   1.18481  -0.99924   0.27701 ];
B8(25,:)=[   0.00000   0.51798  -0.83533   0.00870   0.94700  -0.76500   0.20103 ];
B8(26,:)=[   0.00000   2.62203  -8.23088  11.51642  -8.70056   3.58958  -0.62501 ];
B8(27,:)=[   0.00000   0.42962  -1.01295   0.54166   0.50327  -0.64747   0.19154 ];
B8(28,:)=[   0.00000   0.41087  -1.04412   0.79721   0.05285  -0.30276   0.08986 ];
B8(29,:)=[   0.00000   0.65250  -1.93053   2.07097  -0.87807   0.07109   0.01458 ];
B8(30,:)=[   0.00000   0.72620  -2.22388   2.75749  -1.84546   0.77615  -0.18460 ];
B8(31,:)=[   0.00000   0.60371  -0.94657   0.27878  -0.05967   0.32441  -0.15445 ];
B8(32,:)=[   0.00000   0.57307  -1.62886   1.42360  -0.08746  -0.42020   0.13997 ];
B8(33,:)=[   0.00000   0.46469  -0.55602  -0.25155   0.25289   0.31078  -0.19944 ];
B8(34,:)=[   0.00000   0.54867  -0.88928   0.26689  -0.08200   0.33228  -0.15541 ];
B8(35,:)=[   0.00000   0.64505  -1.22030   0.72653  -0.38185   0.39183  -0.14117 ];

A8( 1,:)=[   1.00000   2.60245   2.76739   1.26458  -0.03990  -0.28192  -0.09525 ];
A8( 2,:)=[   1.00000   1.49240   1.40174   0.87653   0.52333   0.22079   0.03369 ];
A8( 3,:)=[   1.00000   1.01850   0.99828   0.52939   0.34774   0.17759   0.02745 ];
A8( 4,:)=[   1.00000   0.60685   0.79085   0.30913   0.23108   0.15114   0.02251 ];
A8( 5,:)=[   1.00000   0.23598   0.70817   0.14650   0.14903   0.13125   0.01669 ];
A8( 6,:)=[   1.00000  -0.06753   0.69945   0.04028   0.08366   0.12342   0.01105 ];
A8( 7,:)=[   1.00000  -0.31421   0.71977  -0.02012   0.01975   0.12613   0.00500 ];
A8( 8,:)=[   1.00000  -0.47153   0.72602  -0.01866  -0.04151   0.12899   0.00892 ];
A8( 9,:)=[   1.00000  -0.65704   0.74018  -0.00227  -0.13816   0.15893  -0.00601 ];
A8(10,:)=[   1.00000  -0.70758   0.61912   0.18605  -0.31355   0.21672  -0.01673 ];
A8(11,:)=[   1.00000  -1.14182   1.08120  -0.26357  -0.12174   0.15392  -0.02403 ];
A8(12,:)=[   1.00000  -0.89591   0.54067   0.38314  -0.50441   0.25799  -0.01260 ];
A8(13,:)=[   1.00000  -1.41213   1.28565  -0.37003  -0.11866   0.14048  -0.01685 ];
A8(14,:)=[   1.00000  -1.22597   0.84622   0.14318  -0.39835   0.19259  -0.00187 ];
A8(15,:)=[   1.00000  -1.60221   1.41093  -0.37525  -0.18271   0.16282  -0.02156 ];
A8(16,:)=[   0.00000   1.00000  -1.52762   1.13168   0.03202  -0.39382   0.17943 ];
A8(17,:)=[   0.00000   1.00000  -1.43595   0.72828   0.57928  -0.71246   0.23963 ];
A8(18,:)=[   0.00000   1.00000  -1.13526   0.57156   0.33485  -0.19470   0.06080 ];
A8(19,:)=[   0.00000   1.00000  -1.15520   0.54586   0.33362  -0.17724   0.07024 ];
A8(20,:)=[   0.00000   1.00000  -1.09876   0.20470   0.67886  -0.33821   0.07489 ];
A8(21,:)=[   0.00000   1.00000  -1.18832   0.48271   0.32173  -0.14214   0.07086 ];
A8(22,:)=[   0.00000   1.00000  -1.55707   0.68214   0.42774  -0.35898   0.09093 ];
A8(23,:)=[   0.00000   1.00000  -2.69384   2.69921  -0.89018  -0.23827   0.16752 ];
A8(24,:)=[   0.00000   1.00000  -2.68083   2.70737  -0.97655  -0.12595   0.12694 ];
A8(25,:)=[   0.00000   1.00000  -2.55311   2.47754  -0.89356  -0.04971   0.08492 ];
A8(26,:)=[   0.00000   1.00000  -1.73922   0.67066   0.50474  -0.39042   0.08329 ];
A8(27,:)=[   0.00000   1.00000  -3.17008   3.77605  -1.90568   0.25038   0.05534 ];
A8(28,:)=[   0.00000   1.00000  -3.17244   3.82324  -2.07540   0.45517  -0.02596 ];
A8(29,:)=[   0.00000   1.00000  -3.35069   4.37683  -2.78676   0.89827  -0.13717 ];
A8(30,:)=[   0.00000   1.00000  -3.25678   4.28607  -2.99186   1.22383  -0.25675 ];
A8(31,:)=[   0.00000   1.00000  -1.89939   0.68816   0.56705  -0.36488   0.04381 ];
A8(32,:)=[   0.00000   1.00000  -3.42988   4.43102  -2.58489   0.61576  -0.03191 ];
A8(33,:)=[   0.00000   1.00000  -1.98828   0.71229   0.69386  -0.42346   0.02216 ];
A8(34,:)=[   0.00000   1.00000  -2.01213   0.83832   0.52607  -0.37111   0.03568 ];
A8(35,:)=[   0.00000   1.00000  -1.98249   0.80035   0.51857  -0.36139   0.04129 ];




h=freqz(Bpe8,1,W);

   for k=1:35,
     h=h.*freqz(B8(k,:),A8(k,:),W);
     HSen(k,:)=h;
   end

%WCF=argmax(H,W);	%--- Characteristic (angular) Frequencies.



